{% extends 'base.html' %}
{% load static %}
{% load video_tags %} -

{% block content%}

<section class="py-5">
    <div class="container">
        <div class="row justify-content-center">
            
                <h1 style="font-weight: 600;">Quality Control</h1>
                <h2 style="color: #c71782; font-weight: 300;">Precision and Quality in Practice at Caritas Hospital</h2>
                
        </div>
        <div class="row px-3">
            <div class="col-lg-8 col-md-10 col-sm-12 text-center px-0 " style="margin:auto 0;">
                <img src="{% static 'img/quality1.png' %}" class="img-fluid" alt="Cancer Institute Image" />
            </div>
            <div class="col-lg-4 col-md-10 col-sm-12 px-5 py-5" style="background-color: #c71782;">
                <div class="col-content text-justify">
                    <h4 class="text-light">Have Questions?<br/>We're Here to Help</h4>
                    <p class="text-light">Feel free to reach out, and let's embark on a journey to better health together.</p>

                     {% include 'caritasapp/enquiry_form_template.html' %}
                     
                </div>
            </div>
        </div>
    </div>
</section>

<section >
    <div class="container">
        
            <div class="row mt-4" >
                <div class="col-lg-12" >
                        <h3>Setting the Standard for Healthcare Excellence at Caritas Hospital</h3>    
                        <p>Quality Control Department of Caritas Hospital implements and timely updates the quality improvement programmes in the hospital. The department consists of four personnel and a team approach is followed by them with all department heads, both clinical and non-clinical, to guide the hospital in complying with standards of NABH Accreditation, NABH Nursing Excellence Certification, NABH Ethics Committee Accreditation and ISO 9001-2015 Certification. The department prepares, amends and revises manuals and SOPs of all departments and services as and when necessary. </p>
                        <p>The department reviews the performance of the hospital through different quality indicators captured on a monthly basis, analyze the trend and suggest necessary improvements to the Core Team as when required. The department conducts periodic internal audits, facility rounds etc. to ensure that the hospital is in compliance with recommended standards. </p>
                        <p>The department acts as a facilitator to ensure quality and safety in the services provided by the hospital.</p>
                </div>
               
            </div>
              
        </div>
</section>

<section>
    <div class="container">
    <h3>Transparency in Quality</h3>
    <p>At Caritas Hospital, we believe in complete transparency when it comes to our commitment to quality healthcare. To uphold this commitment, we provide realtime access to our Quality Indicators.</p>
    <div class="row">
   
        
    <form method="POST" action="" class="filter-form" id="filterForm">
          {% csrf_token %}

                    <div class="col-lg-5 form-group" style=" display: flex; align-items: justify;" id="biofilter">
                        <label for="year" style="width: 150px; margin-right: 10px;padding-top:6px;">Filter Data by:</label>
                        <select name="year" id="year">
                            <option value="">Select Year</option>
                            <option value="2023">2023</option>
                            
                        </select>
                        <select name="month" id="month">
                            <option value="">Select Month</option>
                            <option value="1">January</option>
                            <option value="2">February</option>
                            <option value="3">March</option>
                            <option value="4">April</option>
                            <option value="5">May</option>
                            <option value="6">June</option>
                            <option value="7">July</option>
                            <option value="8">August</option>
                            <option value="9">September</option>
                            <option value="10">October</option>
                            <option value="11">November</option>
                            <option value="12">December</option>
                        </select>
                        <button type="button" id="filterButton" class="btn enqrybtn px-4">Filter</button>
            
                    </div>
                </form>


    </div>
    
    <div class="row mt-5" id="resultsContainer">
        {% if quality %}
        {% for item in quality %}
        <div class="col-lg-3 mb-4 " >
            <div class="p-4" style="background:#FAF9F9;">
                    <p>Average Length of Stay of Patients (In Days)</p>
                    <h3 id="average_length">{{ item.average_length }}</h3>
                    <h3 id="month_year">{{ item.month_year }}</h3>
                
            </div>
     
         
        </div>
        <div class="col-lg-3 mb-4" >
            <div class="p-4" style="background:#FAF9F9;">
                    <p>Patient Satisfaction <br /> Index</p>
                    <h3 id="patient_satisfaction">{{ item.patient_satisfaction }}</h3>
                    
            </div>
     
         
        </div>
        <div class="col-lg-3 mb-4" >
            <div class="p-4" style="background:#FAF9F9;">
                    <p>Catheter Associated Urinary <br /> Tract Infection (CAUTI) Rate</p>
                    <h3 id="cauti">{{ item.cauti }}</h3>
                
            </div>
     
         
        </div>
            <div class="col-lg-3 mb-4">
            <div class="p-4" style="background:#FAF9F9;">
                    <p>Ventilator Associated <br /> Pneumonia (VAP) Rate</p>
                    <h3 id="vap">{{ item.vap }}</h3>
                   
            </div>
     
         
        </div>
        <div class="col-lg-3 mb-4" >
            <div class="p-4" style="background:#FAF9F9;">
                    <p>Central Line Associated Blood Stream Infection (CLABSI) Rate</p>
                    <h3 id="clabsi">{{ item.clabsi }}</h3>
                   
            </div>
     
         
        </div>
        <div class="col-lg-3 mb-4" >
            <div class="p-4" style="background:#FAF9F9;">
                    <p>Surgical Site <br/>Infection (SSI) rate</p>
                    <h3 id="ssi">{{ item.ssi}}</h3>
                    
            </div>
     
         
        </div>
        <div class="col-lg-3 mb-4" >
            <div class="p-4" style="background:#FAF9F9;">
                    <p>Incidence of Hospital Associated Pressure Ulcers After Admission</p>
                    <h3 id="pressure_ulcers_afteradmission">{{ item.pressure_ulcers_afteradmission }}</h3>
                   
            </div>
     
         
        </div>
        <div class="col-lg-3 mb-4" >
            <div class="p-4" style="background:#FAF9F9;">
                    <p>Compliance to Hand Hygiene Practice by Hospital Personnel</p>
                    <h3 id="compliance_hand_hygiene">{{ item.compliance_hand_hygiene}}</h3>
                    
            </div>
     
         
        </div>
        {% endfor %}
        
         {% else %}
                <!-- Display message if no data found -->
                <div class="col">
                    <h6>No data found.</h6>
                </div>
            {% endif %}
    </div>
    </div>
</section>



<!-- Add Bootstrap JS  -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
    integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
    integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
    crossorigin="anonymous"></script>

<!-- moment js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>

     
     
<script>
    $(document).ready(function () {
        $('#filterButton').click(function () {
            filterResults();
        });
    });

    function filterResults() {
        var year = $('#year').val();
        var month = $('#month').val();

        if (year && month) {
         
            $.ajax({
                type: 'POST',
                url: '/quality-control#filterform', 
                data: {
                    'year': year,
                    'month': month,
                    csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val(),
            action: 'post'
                },
                dataType: 'json',
                success: function (response) {
                              

                    if(response?.quality?.length == 0)
                        return
                        
                    
                    const average_length = response.quality[0].average_length
                    const month_year = response.quality[0].month_year
                    const formattedDate = moment(month_year).format('MMM. D, YYYY');
                    const patient_satisfaction = response.quality[0].patient_satisfaction
                    const cauti = response.quality[0].cauti
                    const vap = response.quality[0].vap
                    const clabsi = response.quality[0].clabsi
                    const ssi = response.quality[0].ssi
                    const pressure_ulcers_afteradmission = response.quality[0].pressure_ulcers_afteradmission
                    const compliance_hand_hygiene = response.quality[0].compliance_hand_hygiene

                    document.getElementById('average_length').innerText = average_length
                    document.getElementById('month_year').innerText = formattedDate
                    document.getElementById('patient_satisfaction').innerText = patient_satisfaction
                    document.getElementById('cauti').innerText = cauti
                    document.getElementById('vap').innerText = vap
                    document.getElementById('clabsi').innerText = clabsi
                    document.getElementById('ssi').innerText = ssi
                    document.getElementById('pressure_ulcers_afteradmission').innerText = pressure_ulcers_afteradmission
                    document.getElementById('compliance_hand_hygiene').innerText = compliance_hand_hygiene


                    // $('#resultsContainer').html(response);
                },
                error: function(xhr, errmsg, err) {
                    console.log(xhr.status + ": " + xhr.responseText);
                }
            });
        } else {
            alert('Please select both year and month.');
        }
    }
</script>
 

{% endblock%}